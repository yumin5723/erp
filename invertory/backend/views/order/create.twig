{% set sidebar_name = "下订单" %}
{% set menu_name = "order" %}
{% extends "../layouts/header.twig" %}
{% block content %}
        <div class="page-head">
        <!-- Page heading -->
        <h2 class="pull-left"><i class="fa fa-file-o"></i> Order</h2>
        </h2>


        <!-- Breadcrumb -->
        <div class="bread-crumb pull-right">
          <a href="index.html"><i class="fa fa-home"></i> Home</a> 
          <!-- Divider -->
          <span class="divider">/</span> 
          <a href="#" class="bread-current">Forms</a>
        </div>

        <div class="clearfix"></div>

      </div>
        <!-- Page heading ends -->
        <!-- Matter -->
         <div class="matter">
        <div class="container">

          <div class="row">

            <div class="col-md-12">


              <div class="widget wgreen">
                
                <div class="widget-head">
                  <div class="pull-left">Forms</div>
                  <div class="widget-icons pull-right">
                    <a href="forms.html#" class="wminimize"><i class="fa fa-chevron-up"></i></a> 
                  </div>
                  <div class="clearfix"></div>
                </div>
                {% include "../layouts/notice.twig" %}
                <div class="widget-content">
                  <div class="padd">

                    <br />
                    <!-- Form starts.  -->
                     {% set form = activeform.begin({'id':'create-form','layout':'horizontal','fieldConfig':{'horizontalCssClasses':{'wrapper':'col-lg-5'} } }) %}     
                          {{ form.field(model,'storeroom_id').dropDownList(model.getCanUseStorerooms()).label(null,{'class':'control-label col-lg-2'})|raw }} 
                          <div class="form-group">
                              <label class="col-lg-2 control-label">Owner</label>
                              <div class="col-lg-5">
                                {{ 
                                widget('\\kartik\\widgets\\Select2',{
                                    'model':model,
                                    'attribute':'owner_id',
                                    'data':model.getCanUseOwner(),
                                    'options':{'placeholder':'Select a owner ...','onchange':'getGoods()'},
                                    'pluginOptions':{'allowClear':true},
                                 })
                             }}
                              </div>
                            </div>
                           <div class="form-group">
                              <label class="col-lg-2 control-label">Goods</label>
                              <div class="col-lg-5">
                                {{ 
                                widget('\\kartik\\widgets\\Select2',{
                                    'model':model,
                                    'attribute':'goods_code',
                                    'data':{0:""},
                                    'options':{'placeholder':'Select a owner ...','onchange':'getGoods()'},
                                    'pluginOptions':{'allowClear':true},
                                 })
                             }}
                              </div>
                            </div>

                          {{ form.field(model,'goods_code',{'inputOptions':{'class':'form-control'}}).label(null,{'class':'control-label col-lg-2'})|raw}}
                          {{ form.field(model,'goods_quantity',{'inputOptions':{'class':'form-control'}}).label(null,{'class':'control-label col-lg-2'})|raw}}
                          {{ form.field(model,'recipients',{'inputOptions':{'class':'form-control'}}).label(null,{'class':'control-label col-lg-2'})|raw}}
                          {{ form.field(model,'recipients_address',{'inputOptions':{'class':'form-control'}}).label(null,{'class':'control-label col-lg-2'})|raw}}
                          {{ form.field(model,'recipients_contact',{'inputOptions':{'class':'form-control'}}).label(null,{'class':'control-label col-lg-2'})|raw}}
                           {{ form.field(model,'goods_code',{'inputOptions':{'class':'form-control'}}).label(null,{'class':'control-label col-lg-2'})|raw}}
                            {{ form.field(model,'info').textArea({'row':2}).label(null,{'class':'control-label col-lg-2'})|raw }}
                                    <hr />
                                <div class="form-group">
                                  <div class="col-lg-offset-2 col-lg-6">
                                    <button type="submit" class="btn btn-primary">Save</button>
                                  </div>
                                </div>
                               {{ void(form.end()) }}
                  </div>
                </div>
                  <div class="widget-foot">
                    <!-- Footer goes here -->
                  </div>
              </div>  

            </div>

          </div>

        </div>
      </div>
<script type="text/javascript">
function getGoods(){
    var owner_id = $("#order-owner_id").val();
    var storeroom_id = $("#order-storeroom_id").val();
    $.ajax({
        type : "POST",
        url:"/order/getgoods",
        dataType : "json",
        data : {"owner_id":owner_id,"storeroom_id":storeroom_id},
        success : function(data){
            var html = "";
            $.each(data,function(k,v){
                html += "<option value='"+k+"'>"+v+"</option>";
            });
            $("#select2-chosen-2").text("Select a owner ...");
            $("#order-goods_code").html(html);

        }
    });
}
</script>
{% endblock %}
